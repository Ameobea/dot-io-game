syntax = "proto3";

import "message_common.proto";

message PlayerEntity {
  fixed32 size = 1;
  float velocity_x = 2; // pixels/tick (60 ticks/second)
  float velocity_y = 3; // pixels/tick (60 ticks/second)
}

message AsteroidEntity {
  float velocity_x = 1;
  float velocty_y = 2;
  float rotation = 3;
  float delta_rotation = 4;
  repeated float vert_coords = 5; // List of vertices as [x1, y1, x2, y2, ...]
}

message CreationEvent {
  float pos_x = 1;
  float pos_y = 2;
  oneof entity {
    PlayerEntity player = 3;
    AsteroidEntity asteroid = 4;
  }
}

message StatusUpdate {
  enum SimpleEvent {
    DELETION = 0;
  }

  oneof payload {
    CreationEvent creation_event = 1;
    SimpleEvent other = 2;
  }
}

message Snapshot {
  message SnapshotItem {
    Uuid id = 1;
    CreationEvent item = 2;
  }

  repeated SnapshotItem items = 1;
}

message MovementUpdate {
  float pos_x = 1;
  float pos_y = 2;
  float velocity_x = 3; // pixels/tick (60 ticks/second)
  float velocity_y = 4; // pixels/tick (60 ticks/second)
}

message ServerMessage {
  Uuid id = 1;
  oneof payload {
    MovementUpdate movement_update = 2;
    StatusUpdate status_update = 3;
  }
}
